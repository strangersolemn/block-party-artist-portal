<!DOCTYPE html>
<html>
<head>
    <title>Simple Mask Test</title>
    <style>
        body { background: #1a1a2e; color: white; font-family: Arial; padding: 20px; }
        .container { display: flex; gap: 20px; }
        .box { border: 2px solid #ef4d99; }
        canvas { display: block; }
        button { background: #2e5130; color: white; border: none; padding: 10px 20px; margin: 5px; cursor: pointer; }
        .controls { background: #2a2a4e; padding: 15px; border-radius: 10px; margin-top: 10px; }
        .controls label { display: inline-block; width: 70px; }
        .controls input { width: 60px; margin-right: 10px; }
    </style>
</head>
<body>
    <h2>Adjust until it fits perfectly, then copy values</h2>
    
    <div class="container">
        <div>
            <h3>Result (500x500)</h3>
            <canvas id="result" width="500" height="500" class="box"></canvas>
            <div class="controls">
                <div>
                    <label>X:</label>
                    <input type="number" id="maskX" value="-63" onchange="compose()">
                    <button onclick="adjust('maskX', -5)">‚Üê</button>
                    <button onclick="adjust('maskX', 5)">‚Üí</button>
                </div>
                <div>
                    <label>Y:</label>
                    <input type="number" id="maskY" value="318" onchange="compose()">
                    <button onclick="adjust('maskY', -5)">‚Üë</button>
                    <button onclick="adjust('maskY', 5)">‚Üì</button>
                </div>
                <div>
                    <label>Scale:</label>
                    <input type="number" id="maskScale" value="0.26" step="0.01" onchange="compose()">
                    <button onclick="adjust('maskScale', -0.01)">-</button>
                    <button onclick="adjust('maskScale', 0.01)">+</button>
                </div>
                <div>
                    <label>Rotation:</label>
                    <input type="number" id="maskRotation" value="30" onchange="compose()">
                    <button onclick="adjust('maskRotation', -2)">‚Ü∂</button>
                    <button onclick="adjust('maskRotation', 2)">‚Ü∑</button>
                </div>
                <br>
                <button onclick="copyValues()" style="background:#ef4d99; width:100%;">üìã COPY VALUES</button>
                <div id="output" style="margin-top:10px; font-family:monospace; background:#000; padding:10px;"></div>
            </div>
        </div>
        
        <div>
            <h3>Draw here (500x500)</h3>
            <canvas id="drawing" width="500" height="500" class="box" style="cursor:crosshair"></canvas>
            <br>
            <button onclick="clearDrawing()">CLEAR</button>
            <button onclick="fillRed()">FILL RED (test)</button>
        </div>
    </div>
    
    <script>
        const resultCanvas = document.getElementById('result');
        const resultCtx = resultCanvas.getContext('2d');
        const drawingCanvas = document.getElementById('drawing');
        const drawingCtx = drawingCanvas.getContext('2d');
        
        // Drawing state
        let isDrawing = false;
        
        // Load images
        const frogBody = new Image();
        const catFull = new Image();
        const catOutline = new Image();
        const maskImg = new Image();
        const maskOutline = new Image();
        
        frogBody.src = 'Body_sprites/1body-sprite.avif';
        catFull.src = 'cat-full.png';
        catOutline.src = 'cat-outline-positioned.png';
        maskImg.src = 'Centre_mask_mask.png';
        maskOutline.src = 'Centre_mask_outline.png';
        
        // Show mask outline on drawing canvas
        maskOutline.onload = function() {
            drawingCtx.drawImage(maskOutline, 0, 0, 500, 500);
        };
        
        function getValues() {
            return {
                x: parseFloat(document.getElementById('maskX').value),
                y: parseFloat(document.getElementById('maskY').value),
                scale: parseFloat(document.getElementById('maskScale').value),
                rotation: parseFloat(document.getElementById('maskRotation').value)
            };
        }
        
        function adjust(id, delta) {
            const input = document.getElementById(id);
            input.value = (parseFloat(input.value) + delta).toFixed(id === 'maskScale' ? 2 : 0);
            compose();
        }
        
        function copyValues() {
            const v = getValues();
            const text = `X=${v.x}, Y=${v.y}, Scale=${v.scale}, Rotation=${v.rotation}`;
            navigator.clipboard.writeText(text);
            document.getElementById('output').innerHTML = '<span style="color:#0f0">COPIED!</span><br>' + text;
        }
        
        function compose() {
            const v = getValues();
            
            // Clear result
            resultCtx.fillStyle = '#0a0a1b';
            resultCtx.fillRect(0, 0, 500, 500);
            
            // Draw frog body
            resultCtx.drawImage(frogBody, 0, 0, 500, 500, 0, 0, 500, 500);
            
            // Draw cat (behind mask)
            resultCtx.drawImage(catFull, 0, 0, 500, 500);
            
            // Place the user's drawing
            const size = 500 * v.scale;
            
            resultCtx.save();
            resultCtx.translate(v.x + size/2, v.y + size/2);
            resultCtx.rotate(v.rotation * Math.PI / 180);
            resultCtx.drawImage(drawingCanvas, -size/2, -size/2, size, size);
            resultCtx.restore();
            
            // Draw cat outline on top
            resultCtx.drawImage(catOutline, 0, 0, 500, 500);
            
            // Update output
            document.getElementById('output').textContent = `X=${v.x}, Y=${v.y}, Scale=${v.scale}, Rotation=${v.rotation}`;
        }
        
        function clearDrawing() {
            drawingCtx.clearRect(0, 0, 500, 500);
            drawingCtx.drawImage(maskOutline, 0, 0, 500, 500);
        }
        
        function fillRed() {
            drawingCtx.fillStyle = 'red';
            drawingCtx.fillRect(0, 0, 500, 500);
            compose();
        }
        
        // Simple drawing
        drawingCanvas.addEventListener('mousedown', (e) => {
            isDrawing = true;
        });
        
        drawingCanvas.addEventListener('mousemove', (e) => {
            if (!isDrawing) return;
            const rect = drawingCanvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            drawingCtx.fillStyle = 'red';
            drawingCtx.beginPath();
            drawingCtx.arc(x, y, 10, 0, Math.PI * 2);
            drawingCtx.fill();
        });
        
        drawingCanvas.addEventListener('mouseup', () => { isDrawing = false; compose(); });
        drawingCanvas.addEventListener('mouseleave', () => { isDrawing = false; });
        
        // Auto-compose when images load
        catOutline.onload = compose;
    </script>
</body>
</html>
